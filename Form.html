<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Book Ticket</title>
  <style>

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f0f4f8;
      overflow-x: hidden;
    }

    .train-card {
      background: #f9fafb;
      border: 1px solid #ddd;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .train-card:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    h2 {
      text-align: center;
      margin-bottom: 25px;
      color: #2f4676;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px 10px;
      width: 100%;
      margin-bottom: 15px;
    }

    .form-group {
      grid-column: span 1;
    }

    input, select {
      width: 93%;
      padding: 10px 10px;
      border: 1px solid #2f4676;
      border-radius: 5px;
      font-size: 16px;
    }

    button {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      background-color: #1e3a8a;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background-color: #3b5bba;
    }

    .autocomplete-list {
      top: 100%;
      left: 0;
      right: 0;
      border-top: none;
      z-index: 10;
    }

    .autocomplete-list div {
      padding: 8px;
      cursor: pointer;
    }

    .autocomplete-list div:hover {
      background-color: #f0f0f0;
    }

    input[type="date"] ,
    select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background-color: #fff;
      padding: 10px 12px;
      font-size: 15px;
      border: 1px solid #2f4676;
      border-radius: 5px;
      width: 100%;
      box-sizing: border-box;
    }
    
    /* Mobile responsiveness */
@media (max-width: 768px) {
   .outer-wrapper {
      padding: 20px;
      flex-direction: column;
      gap: 20px;  
    }
    
     .main-wrapper {
      align-items: center;
    }
     
}
    
    .outer-wrapper {
      display: flex;
      padding: 20px;
      flex-direction: column;
      gap: 20px;  
      align-items: flex-start;
    }

    .main-wrapper {
      display: flex;
      flex-direction: column; 
      /*align-items: left;*/
      gap: 20px;      
    }

    .side-wrapper {
      display: flex;   
    }

    #side-container {
      width: 100%;
      background: #fff;
      color: #1e3a8a;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      box-sizing: border-box;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    
    .form-container,
    #result-container {
      width: 100%;
      background: #fff;
      color: #1e3a8a;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      box-sizing: border-box;
    }
    
    #result-container {
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.4s ease;
    }

    .flip-button-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .flip-btn {
      font-size: 16px;
      padding: 2px 2px;
      color: #1e3a8a;
      border: none;
      background: rgba(20,87,167,0);
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .flip-btn:hover {
      background: #d1d5db;
    }

    .topbar {
      position: sticky;
      top: 0;
      background: #203a43;
      color: #fff;
      text-align: center;
      padding: 15px 0;
      font-size: 20px;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .login-row {
  display: flex;
  align-items: center;
  gap: 10px;
}

.login-row input[type="text"],
.login-row input[type="password"] {
  padding: 6px;
  font-size: 14px;
  flex: 1; /* grow evenly */
}

  </style>
</head>
<body>
  <div class="topbar">
    üöÄ PUNISHER AUTOMATION
  </div>
    <div class="outer-wrapper">
      <div class="main-wrapper">
        <div class="form-container" id="formContainer">
          <h2>FIND TRAIN</h2>
            <div class="form-grid">

                <div class="form-group" style="grid-column: span 2;">
                  <input type="text" id="from" placeholder="From">
                  <div id="from-list" class="autocomplete-list"></div>
                </div>

                <div class="form-group flip-button-container" style="grid-column: span 2;">
                  <button type="button" id="flip" class="flip-btn" onclick="flipFromTo()">‚Üë‚Üì</button>
                </div>

                <div class="form-group" style="grid-column: span 2;">
                    <input type="text" id="to" placeholder="To">
                    <div id="to-list" class="autocomplete-list"></div>
                </div>
                <div class="form-group">
                    <select id="class">
                    <option value="SL">Sleeper (SL)</option>
                    <option value="3A">AC 3 Tier (3A)</option>
                    <option value="2A">AC 2 Tier (2A)</option>
                    <option value="1A">AC First Class (1A)</option>
                    <option value="CC">AC Chair Car (CC)</option>
                    </select>
                </div>
                <div class="form-group">
                    <select id="quota">
                    <option value="GN">GENERAL</option>
                    <option value="TQ">TATKAL</option>
                    <option value="PT">PREMIUM TATKAL</option>
                    </select>
                </div>
                <div class="form-group" style="grid-column: span 2;">
                    <input type="date" id="date" placeholder="Date" onclick="this.showPicker()" required>
                </div>
                </div>
                <div style="display: flex; gap: 15px;">
                    <button onclick="searchTrain()" id="search_button" style="flex: 1;">Search</button>
                    <button onclick="location.reload()"id="refresh_button" style="flex: 1">Reset</button>
                    <!-- <button onclick="saveJSON()" style="flex: 1; background-color: #16a34a;">Save JSON</button> -->
                    </div>
            </div>
            <div id="result-container">
                <div id="loading" style="display: none; text-align: center;">
                    <p>üîÑ Loading trains...</p>
                </div>
                <div id="train-results"></div>
            </div>
      </div>
      <div class="side-wrapper">
        <div id="side-container">
        <fieldset>
  <legend>IRCTC Login</legend>
    <style>
    fieldset {
      padding: 15px;
      border: 1px solid #ccc;
      margin-bottom: 20px;
    }

    .login-box {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 10px;
      border: 1px solid #eee;
      margin-bottom: 15px;
      background: #f9f9f9;
    }
    </style>
    <div class ="login-box">
  <div class="login-row" >
    <input type="text" placeholder="Username" />
    <input type="password" placeholder="Password" />
  </div>
  <label style="display: flex; align-items: center; gap: 6px; margin-bottom: 10px;"><input type="checkbox" name="freeCaptcha" style="width: auto; margin: 0;">Free Captcha</label>
  </div>
</fieldset>
<fieldset>
  <legend>Passenger Details</legend>

  <style>
    fieldset {
      padding: 15px;
      border: 1px solid #ccc;
      margin-bottom: 20px;
    }

    .passenger-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 10px;
      border: 1px solid #eee;
      margin-bottom: 15px;
      background: #f9f9f9;
    }

    .row-group {
      display: flex;
      gap: 10px;
    }

    .row-group input[type="text"] {
      flex: 3;
      padding: 6px;
    }

    .row-group input[type="number"] {
      flex: 1;
      padding: 6px;
    }

    .row-group select {
      flex: 1;
      padding: 6px;
    }

    .passenger-label {
      font-weight: bold;
      margin-bottom: 5px;
    }
  </style>

  <!-- Passenger 1 -->
  <div id="row-1" class="passenger-row">
    <div class="passenger-label">Passenger 1</div>
    <div class="row-group">
      <input type="text" id="name-1" name="passenger-name-1" placeholder="Name" maxlength="16">
      <input type="number" id="age-1" name="age-1" maxlength="3" placeholder="Age" min="0">
    </div>
    <div class="row-group">
      <select id="gender-1" name="passenger-gender-1">
        <option value="">Gender</option>
        <option value="M">Male</option>
        <option value="F">Female</option>
      </select>
      <select id="berth-1" name="passenger-berth-1">
        <option value="">Berth</option>
        <option>UB</option><option>LB</option><option>MB</option>
        <option>SL</option><option>SU</option><option>WS</option>
        <option>CB</option><option>CP</option><option>SM</option>
      </select>
      <select id="food-1" name="passenger-food-1">
        <option value="">Food</option>
        <option value="V">Veg</option>
        <option value="N">Non-Veg</option>
        <option value="D">No Food</option>
      </select>
    </div>
  </div>

  <!-- Passenger 2 -->
  <div id="row-2" class="passenger-row">
    <div class="passenger-label">Passenger 2</div>
    <div class="row-group">
      <input type="text" id="name-2" name="passenger-name-2" placeholder="Name" maxlength="16">
      <input type="number" id="age-2" name="age-2" placeholder="Age" maxlength="3" min="0" max="125">
    </div>
    <div class="row-group">
      <select id="gender-2" name="passenger-gender-2">
        <option value="">Gender</option>
        <option value="M">Male</option>
        <option value="F">Female</option>
      </select>
      <select id="berth-2" name="passenger-berth-2">
        <option value="">Berth</option>
        <option>UB</option><option>LB</option><option>MB</option>
        <option>SL</option><option>SU</option><option>WS</option>
        <option>CB</option><option>CP</option><option>SM</option>
      </select>
      <select id="food-2" name="passenger-food-2">
        <option value="">Food</option>
        <option value="V">Veg</option>
        <option value="N">Non-Veg</option>
        <option value="D">No Food</option>
      </select>
    </div>
  </div>

  <!-- Passenger 3 -->
  <div id="row-3" class="passenger-row">
    <div class="passenger-label">Passenger 3</div>
    <div class="row-group">
      <input type="text" id="name-3" name="passenger-name-3" placeholder="Name" maxlength="16">
      <input type="number" id="age-3" name="age-3" placeholder="Age" maxlength="3" min="0" max="125">
    </div>
    <div class="row-group">
      <select id="gender-3" name="passenger-gender-3">
        <option value="">Gender</option>
        <option value="M">Male</option>
        <option value="F">Female</option>
      </select>
      <select id="berth-3" name="passenger-berth-3">
        <option value="">Berth</option>
        <option>UB</option><option>LB</option><option>MB</option>
        <option>SL</option><option>SU</option><option>WS</option>
        <option>CB</option><option>CP</option><option>SM</option>
      </select>
      <select id="food-3" name="passenger-food-3">
        <option value="">Food</option>
        <option value="V">Veg</option>
        <option value="N">Non-Veg</option>
        <option value="D">No Food</option>
      </select>
    </div>
  </div>

  <!-- Passenger 4 -->
  <div id="row-4" class="passenger-row">
    <div class="passenger-label">Passenger 4</div>
    <div class="row-group">
      <input type="text" id="name-4" name="passenger-name-4" placeholder="Name" maxlength="16">
      <input type="number" id="age-4" name="age-4" placeholder="Age" maxlength="3" min="0" max="125">
    </div>
    <div class="row-group">
      <select id="gender-4" name="passenger-gender-4">
        <option value="">Gender</option>
        <option value="M">Male</option>
        <option value="F">Female</option>
      </select>
      <select id="berth-4" name="passenger-berth-4">
        <option value="">Berth</option>
        <option>UB</option><option>LB</option><option>MB</option>
        <option>SL</option><option>SU</option><option>WS</option>
        <option>CB</option><option>CP</option><option>SM</option>
      </select>
      <select id="food-4" name="passenger-food-4">
        <option value="">Food</option>
        <option value="V">Veg</option>
        <option value="N">Non-Veg</option>
        <option value="D">No Food</option>
      </select>
    </div>
  </div>

  <!-- Passenger 5 -->
  <div id="row-5" class="passenger-row">
    <div class="passenger-label">Passenger 5</div>
    <div class="row-group">
      <input type="text" id="name-5" name="passenger-name-5" placeholder="Name" maxlength="16">
      <input type="number" id="age-5" name="age-5" placeholder="Age" maxlength="3" min="0" max="125">
    </div>
    <div class="row-group">
      <select id="gender-5" name="passenger-gender-5">
        <option value="">Gender</option>
        <option value="M">Male</option>
        <option value="F">Female</option>
      </select>
      <select id="berth-5" name="passenger-berth-5">
        <option value="">Berth</option>
        <option>UB</option><option>LB</option><option>MB</option>
        <option>SL</option><option>SU</option><option>WS</option>
        <option>CB</option><option>CP</option><option>SM</option>
      </select>
      <select id="food-5" name="passenger-food-5">
        <option value="">Food</option>
        <option value="V">Veg</option>
        <option value="N">Non-Veg</option>
        <option value="D">No Food</option>
      </select>
    </div>
  </div>

  <!-- Passenger 6 -->
  <div id="row-6" class="passenger-row">
    <div class="passenger-label">Passenger 6</div>
    <div class="row-group">
      <input type="text" id="name-6" name="passenger-name-6" placeholder="Name" maxlength="16">
      <input type="number" id="age-6" name="age-6" placeholder="Age" maxlength="3" min="0" max="125">
    </div>
    <div class="row-group">
      <select id="gender-6" name="passenger-gender-6">
        <option value="">Gender</option>
        <option value="M">Male</option>
        <option value="F">Female</option>
      </select>
      <select id="berth-6" name="passenger-berth-6">
        <option value="">Berth</option>
        <option>UB</option><option>LB</option><option>MB</option>
        <option>SL</option><option>SU</option><option>WS</option>
        <option>CB</option><option>CP</option><option>SM</option>
      </select>
      <select id="food-6" name="passenger-food-6">
        <option value="">Food</option>
        <option value="V">Veg</option>
        <option value="N">Non-Veg</option>
        <option value="D">No Food</option>
      </select>
    </div>
  </div>
  <div style="margin-top: 10px;">
  <button id="toggle-btn" onclick="togglePassengerRows()">Save</button>
 <!-- <div style="display: inline-flex; gap: 10px; margin-top: 20px;"> <button onclick="saveAndDownloadPassengerJSON()">Save & Download as JSON</button>-->
</div>

<pre id="output" style="margin-top: 15px;"></pre>
</fieldset>
        <fieldset>
          <legend>Other Preferences</legend>
          <!---<div style="padding: 20px; border: 1px solid #ccc; width: 100%; font-family: Arial;">-->
  
  <input
    <span style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%);">üì±</span>
    type="tel"
    placeholder="Enter mobile number"
    style="padding-left: 35px; width: 93%%;"
  />
  <!-- Mobile number input -->
  <input type="tel" placeholder=" üì± Enter mobile number" maxlength="3" style="width: 93%; margin-bottom: 10px;" />

  <!-- First dropdown -->
  <select style="width: 100%; margin-bottom: 10px;">
    <option disabled selected>üìù Travel Insurance </option>
    <option value="yes"> ‚úîÔ∏è Yes</option>
    <option value="no"> üö´ No</option>
  </select>

  <!-- Second dropdown -->
  <select style="width: 100%; margin-bottom: 10px;">
    <option disabled selected> üí∞Payment Selection</option>
    <option value="upi"> üì≤ Pay through BHIM/UPI </option>
    <option value="credit"> üí≥ Credit/Debit Card</option>
  </select>

  <!-- Checkboxes -->
  <label style="display: block; margin-bottom: 5px;">
    <input type="checkbox" style="width: auto; margin: 0;"/> Auto Upgradation to Upper Class.
  </label>
  
  <label style="display: flex; align-items: center; gap: 6px; margin-bottom: 10px;">
    <input type="checkbox" style="width: auto; margin: 0;"/> Book only if confirm berths are allotted.
  </label>

        </fieldset>
        <fieldset>
          <legend>Travel Preferences</legend>
        </fieldset>
        </div>
      </div>
    </div>


  <script>

let rowsHidden = false;

function hasAtLeastOnePassenger() {
  for (let i = 1; i <= 6; i++) {
    const row = document.getElementById(`row-${i}`);
    const name = document.getElementById(`name-${i}`).value.trim();
    if (row.style.display !== "none" && name !== "") {
      return true;
    }
  }
  return false;
}

function togglePassengerRows() {
  if (!hasAtLeastOnePassenger()) {
    alert("At least one passenger name is required.");
    return;
  }

  const toggleBtn = document.getElementById('toggle-btn');

  for (let i = 1; i <= 6; i++) {
    const nameInput = document.getElementById(`name-${i}`);
    const row = document.getElementById(`row-${i}`);

    if (rowsHidden) {
      row.style.display = "flex"; // Restore all
    } else {
      if (nameInput.value.trim() === "") {
        row.style.display = "none"; // Hide empty
      }
    }
  }

  rowsHidden = !rowsHidden;
  toggleBtn.textContent = rowsHidden ? "Restore" : "Save";
}

function getPassengerData() {
  const passengers = [];

  for (let i = 1; i <= 6; i++) {
    const row = document.getElementById(`row-${i}`);
    if (row.style.display === "none") continue;

    const name = document.getElementById(`name-${i}`).value.trim();
    const age = document.getElementById(`age-${i}`).value.trim();
    const gender = document.getElementById(`gender-${i}`).value.trim();
    const berth = document.getElementById(`berth-${i}`).value.trim();
    const food = document.getElementById(`food-${i}`).value.trim();

    passengers.push({
      name: name,
      age: age || "",
      gender: gender || "",
      berth: berth || "",
      food: food || ""
    });
  }

  return { passenger_details: passengers };
}

function saveAndDownloadPassengerJSON() {
  if (!hasAtLeastOnePassenger()) {
    alert("At least one passenger name is required.");
    return;
  }

  const data = getPassengerData();
  document.getElementById('output').textContent = JSON.stringify(data, null, 2);

  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'passenger_details.json';
  a.click();
  URL.revokeObjectURL(url);
}

  function flipFromTo() {
    const fromInput = document.getElementById('from');
    const toInput = document.getElementById('to');

    const temp = fromInput.value;
    fromInput.value = toInput.value;
    toInput.value = temp;
  }
  
    // Set today's date as default in the date input
    document.addEventListener("DOMContentLoaded", () => {
        const dateInput = document.getElementById("date");
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const dd = String(today.getDate()).padStart(2, '0');
        dateInput.value = `${yyyy}-${mm}-${dd}`;
    });
    let stationData = [];

    fetch('https://raw.githubusercontent.com/imlovekumar/Loves/refs/heads/main/Main_code/Station.json')
      .then(response => response.json())
      .then(data => stationData = data);

    function setupAutocomplete(inputId, listId) {
      const input = document.getElementById(inputId);
      const list = document.getElementById(listId);

      input.addEventListener("input", () => {
        const val = input.value.trim().toUpperCase();
        list.innerHTML = '';
        if (val.length < 1) return;

        const matches = stationData.filter(st => st.code.startsWith(val)).slice(0, 10);
        matches.forEach(st => {
          const div = document.createElement("div");
          div.textContent = `${st.name} - ${st.code}`;
          div.addEventListener("click", () => {
            input.value = `${st.name} - ${st.code}`;
            list.innerHTML = '';
          });
          list.appendChild(div);
        });
      });

      document.addEventListener("click", (e) => {
        if (!list.contains(e.target) && e.target !== input) {
          list.innerHTML = '';
        }
      });
    }

    setupAutocomplete("from", "from-list");
    setupAutocomplete("to", "to-list");

    function extractCode(text) {
    // Extracts the last word after ' - ' which is assumed to be the code
    return text.split(" - ").pop().trim().toUpperCase();
    }

    function parseTrainLine(line) {
    const parts = line.split("~");
    return {
        train_number: parts[0],
        train_name: parts[1],
        from_station_name: parts[2],
        from_station_code: parts[3],
        to_station_name: parts[4],
        to_station_code: parts[5],
        departure_station: parts[6],
        departure_code: parts[7],
        arrival_station: parts[8],
        arrival_code: parts[9],
        departure_time: parts[10],
        arrival_time: parts[11],
        travel_time: parts[12],
        running_days: parts[13],
        train_type: parts[30],
    };
    }

    async function fetchTrains(from,to) {   
        const response = await fetch(`https://erail.in/rail/getTrains.aspx?Station_From=${from}&Station_To=${to}`);
        const rawText = await response.text();
        const parts = rawText.split('^');
        // Step 1: Parse Search_data
        const metaParts = parts[0].split("~");
        const Search_data = {
        from_code: metaParts[1],
        from_name: metaParts[2],
        to_code: metaParts[3],
        to_name: metaParts[4]
        };
        const jsonOutput = {
        Search_data,
        trains: parts.slice(1).map(parseTrainLine)
        };
        const jsondata = JSON.stringify(jsonOutput, null, 2);
        //console.log(jsondata);
        return jsondata
    }

    function getFormData() {
    const fromRaw = document.getElementById("from").value;
    const toRaw = document.getElementById("to").value;
    const dateRaw = document.getElementById("date").value;
    const quota = document.getElementById("quota").value;
    const classType = document.getElementById("class").value;
    const from = extractCode(fromRaw);
    const to = extractCode(toRaw);
    const date = dateRaw.replace(/-/g, ""); // Format: yyyymmdd

    return { fromRaw, dateRaw, toRaw, from, to, date, quota, class: classType };
    }

    function doesTrainRunOnDate(running_days, dateStr) {
        // dateStr = "YYYY-MM-DD"
        const date = new Date(dateStr);
        const jsDayIndex = date.getDay(); // 0 = Sunday, ..., 6 = Saturday
        const convertedIndex = (jsDayIndex + 6) % 7; // Convert to 0 = Monday, ..., 6 = Sunday
        return running_days[convertedIndex] === '1';
    }

    async function searchTrain() {
    const data = getFormData();

    if (!data.from || !data.to || !data.date || !data.class || !data.quota) {
        alert("Please fill all fields");
        return;
    }

    const loadingEl = document.getElementById("loading");
    const resultsEl = document.getElementById("train-results");
    const resultContainer = document.getElementById("result-container");

    // ‚úÖ Show it without layout shift
    resultContainer.style.visibility = "visible";
    resultContainer.style.opacity = "1";
    loadingEl.style.display = "block";
    resultsEl.innerHTML = "";

    // Simulate train search (API call can go here)
    setTimeout(() => {
      (async () => {
        loadingEl.style.display = "none";
        console.log("üîç Search Payload:", data);
        const dateStr = data.dateRaw;
        const raw = await fetchTrains(data.from,data.to);
        const responseText = typeof raw === "string" ? JSON.parse(raw) : raw;
        const trains = responseText.trains;
        console.log(trains);

        const filteredTrains = trains.filter(train => 
            doesTrainRunOnDate(train.running_days, dateStr)
        );

        if (filteredTrains.length > 0) {
          filteredTrains.forEach(train => {
            const card = document.createElement("div");
            card.className = "train-card";
            card.innerHTML = `
              <strong>${train.train_number} - ${train.train_name}</strong><br>
              ${train.departure_code} ‚Üí ${train.arrival_code}<br>
              Dep: ${train.departure_time} ‚Üí  Arr: ${train.arrival_time}<br>
              Duration: ${train.travel_time} <br>
            `;
            card.style.cursor = "pointer";
            card.addEventListener("click", () => {
              // Hide all cards except the one clicked
              document.querySelectorAll(".train-card").forEach(c => {
                if (c !== card) c.style.display = "none";
              });
            });
            card.onclick = () => {

              document.getElementById("from").readOnly= true;
              document.getElementById("flip").style.display = "none";
              document.getElementById("to").readOnly = true;
              document.getElementById("class").disabled = true;
              document.getElementById("quota").disabled = true;
              document.getElementById("date").disabled = true;
              document.getElementById("search_button").disabled = true;
              document.getElementById("search_button").style.background = "#d1d5db";
              document.getElementById("side-container").style.visibility = "visible";
              document.getElementById("side-container").style.opacity = "1";
              // Make clicked card unclickable
              card.style.pointerEvents = "none";
              card.style.opacity = "0.8"; // Optional: make it look inactive
              card.style.cursor = "default";

            };
            resultsEl.appendChild(card);
          });
        }
        else {
          const msg = document.createElement("div");
          msg.style = "padding: 15px; color: #555; font-weight: bold;";
          msg.textContent = `‚ùå No train Found`;
          resultsEl.appendChild(msg);
        }
        })();
    }, 1500); // Simulate loading time
    }

    function saveJSON() {
      
      const data = getFormData();

      if (!data.from || !data.to || !data.date) {
          alert("Please fill all fields before saving.");
          return;
      }

      const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
      const url = URL.createObjectURL(blob);

      const a = document.createElement("a");
      a.href = url;
      a.download = "ticket.json";
      a.click();
      URL.revokeObjectURL(url);
    }

  </script>

</body>
</html>